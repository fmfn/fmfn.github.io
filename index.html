<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Data Blog</title>
        <link rel="stylesheet" href="http://fmfn.github.io/theme/css/main.css" />
        <link href="http://fmfn.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Data Blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://fmfn.github.io/">Data Blog </a></h1>
                <nav><ul>
                    <li><a href="http://fmfn.github.io/category/posts.html">posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://fmfn.github.io/test-post.html">Test Post</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-07-31T20:00:00-04:00">
                Published: Sun 31 July 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://fmfn.github.io/author/vik-paruchuri.html">Vik Paruchuri</a>
        </address>
<p>In <a href="http://fmfn.github.io/category/posts.html">posts</a>.</p>
<p>tags: <a href="http://fmfn.github.io/tag/python-firsts.html">python firsts</a> </p>
</footer><!-- /.post-info --><style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [250]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">GRU</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">RepeatVector</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">TimeDistributed</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">keras.objectives</span> <span class="kn">import</span> <span class="n">categorical_crossentropy</span><span class="p">,</span> <span class="n">sparse_categorical_crossentropy</span>
<span class="kn">import</span> <span class="nn">keras.backend</span> <span class="kn">as</span> <span class="nn">K</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="kn">import</span> <span class="nn">string_to_array</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data">Data<a class="anchor-link" href="#Data">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"../data/x_a10k_v15k.csv"</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="c1"># X = pd.read_csv("/mnt/simxiv/data/x_a1M_v150k.csv").values.astype(np.int32)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">"../data/arxiv-10k.json"</span><span class="p">)</span>
<span class="c1"># df = pd.read_json("/mnt/simxiv/data/arxiv-1M.json")</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">maxlen</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">title_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">max_features</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1500</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [253]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="o">%%</span><span class="k">time</span>
Y = []

for _, row in df.iterrows():
    Y.append(string_to_array.string_to_array(row['title'], maxlen=title_size, vocab_file='10k').flatten())
    
Y = np.array(Y)
Y = np.expand_dims(Y, -1)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 14.2 s, sys: 151 ms, total: 14.3 s
Wall time: 14.3 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [99]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="n">X</span> <span class="o">>=</span> <span class="n">max_features</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Y</span><span class="p">[</span><span class="n">Y</span> <span class="o">>=</span> <span class="n">max_features</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model">Model<a class="anchor-link" href="#Model">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">char_softmax</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">K</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">categorical_crossentropy</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">title_size</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">sparse_char_softmax</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">steps_loss</span> <span class="o">=</span> <span class="p">[</span><span class="n">sparse_categorical_crossentropy</span><span class="p">(</span><span class="n">y_true</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">title_size</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">K</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">steps_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [101]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">maxlen</span><span class="p">,</span> <span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">'input'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">'int32'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [102]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">embedding</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'embedding'</span><span class="p">)</span>
<span class="n">embedding</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="n">max_features</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">input_length</span><span class="o">=</span><span class="n">maxlen</span><span class="p">,</span> <span class="n">mask_zero</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"Embedding_layer"</span><span class="p">))</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [103]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">GRU</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'encode_rnn'</span><span class="p">)(</span><span class="n">embedding</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [117]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">RepeatVector</span><span class="p">(</span><span class="n">title_size</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'context_vector'</span><span class="p">)(</span><span class="n">encoder</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">GRU</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'decode_rnn'</span><span class="p">)(</span><span class="n">decoder</span><span class="p">)</span>

<span class="n">decoder</span> <span class="o">=</span> <span class="n">TimeDistributed</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">max_features</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'softmax'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'output_sequence'</span><span class="p">))(</span><span class="n">decoder</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [118]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">decoder</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
input (InputLayer)                 (None, 64)          0                                            
____________________________________________________________________________________________________
embedding (Sequential)             (None, 64, 50)      75000       input[0][0]                      
____________________________________________________________________________________________________
encode_rnn (GRU)                   (None, 25)          5700        embedding[1][0]                  
____________________________________________________________________________________________________
context_vector (RepeatVector)      (None, 16, 25)      0           encode_rnn[0][0]                 
____________________________________________________________________________________________________
decode_rnn (GRU)                   (None, 16, 25)      3825        context_vector[0][0]             
____________________________________________________________________________________________________
timedistributed_5 (TimeDistributed)(None, 16, 1500)    39000       decode_rnn[0][0]                 
====================================================================================================
Total params: 123525
____________________________________________________________________________________________________
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [128]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">sparse_char_softmax</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">'rmsprop'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [229]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="n">maxlen</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">nb_epoch</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[229]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><keras.callbacks.history at 0x2159b3dd0></pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [230]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">u'fivethirtyeight'</span><span class="p">,</span> <span class="s1">'dark_background'</span><span class="p">])</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">'loss'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[230]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[<matplotlib.lines.line2d at 0x122d5ba50>]</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [231]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="p">:</span><span class="n">maxlen</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [232]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">titles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [241]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">string_to_array</span><span class="o">.</span><span class="n">array_to_string</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">titles</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))],</span> <span class="n">vocab_file</span><span class="o">=</span><span class="s1">'10k'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[241]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&apos;acoust weyl node from stack unkown chain&apos;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [238]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">string_to_array</span><span class="o">.</span><span class="n">array_to_string</span><span class="p">(</span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vocab_file</span><span class="o">=</span><span class="s1">'10k'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[238]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&apos;exact solut for optim unkown of unkown unkown and the unkown equat&apos;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [242]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">title</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">titles</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[242]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>u&apos;Acoustic Weyl nodes from stacking dimerized chains&apos;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [237]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">titles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[237]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([611,  91,  11, 115,   1,   3,   1,   1,   5,   2,   1,  81,   0,
         0,   0,   0])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="http://fmfn.github.io/first-post.html" rel="bookmark"
                           title="Permalink to First Post">First Post</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-06-08T20:00:00-04:00">
                Published: Wed 08 June 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://fmfn.github.io/author/me.html">me</a>
        </address>
<p>In <a href="http://fmfn.github.io/category/posts.html">posts</a>.</p>
<p>tags: <a href="http://fmfn.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="First-post!">First post!<a class="anchor-link" href="#First-post!">¶</a></h1><p>This will be the first post in our new Pelican blog! You can add any code or markdown cells to this Jupyter notebook, and they will be rendered on your blog.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
                <a class="readmore" href="http://fmfn.github.io/first-post.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://fmfn.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>